subroutine DPLPCE (MRELAS, NVARS, LMX, LBM, ITLP, ITBRC, IBASIS, &
     IMAT, IBRC, IPR, IWR, IND, IBB, ERDNRM, EPS, TUNE, GG, AMAT, &
     BASMAT, CSC, WR, WW, PRIMAL, ERD, ERP, SINGLR, REDBAS)
!
!! DPLPCE is subsidiary to DSPLP.
!
!***LIBRARY   SLATEC
!***TYPE      DOUBLE PRECISION (SPLPCE-S, DPLPCE-D)
!***AUTHOR  (UNKNOWN)
!***DESCRIPTION
!
!     THE EDITING REQUIRED TO CONVERT THIS SUBROUTINE FROM SINGLE TO
!     DOUBLE PRECISION INVOLVES THE FOLLOWING CHARACTER STRING CHANGES.
!
!     USE AN EDITING COMMAND (CHANGE) /STRING-1/(TO)STRING-2/.
!     /REAL (12 BLANKS)/DOUBLE PRECISION/,
!     /SASUM/DASUM/,/DCOPY/,DCOPY/.
!
!     REVISED 811219-1630
!     REVISED YYMMDD-HHMM
!
!     THIS SUBPROGRAM IS FROM THE DSPLP( ) PACKAGE.  IT CALCULATES
!     THE APPROXIMATE ERROR IN THE PRIMAL AND DUAL SYSTEMS.  IT IS
!     THE MAIN PART OF THE PROCEDURE (COMPUTE ERROR IN DUAL AND PRIMAL
!     SYSTEMS).
!
!***SEE ALSO  DSPLP
!***ROUTINES CALLED  DASUM, DCOPY, DPRWPG, IDLOC, LA05BD
!***REVISION HISTORY  (YYMMDD)
!   811215  DATE WRITTEN
!   890531  Changed all specific intrinsics to generic.  (WRB)
!   890605  Removed unreferenced labels.  (WRB)
!   890606  Changed references from IPLOC to IDLOC.  (WRB)
!   891214  Prologue converted to Version 4.0 format.  (BAB)
!   900328  Added TYPE section.  (WRB)
!***END PROLOGUE  DPLPCE
  INTEGER IBASIS(*),IMAT(*),IBRC(LBM,2),IPR(*),IWR(*),IND(*),IBB(*)
  DOUBLE PRECISION AMAT(*),BASMAT(*),CSC(*),WR(*),WW(*),PRIMAL(*), &
   ERD(*),ERP(*),EPS,ERDNRM,FACTOR,GG,ONE,ZERO,TEN,TUNE
  DOUBLE PRECISION DASUM
  LOGICAL SINGLR,REDBAS,TRANS,PAGEPL
!***FIRST EXECUTABLE STATEMENT  DPLPCE
  ZERO=0.D0
  ONE=1.D0
  TEN=10.D0
  LPG=LMX-(NVARS+4)
  SINGLR=.FALSE.
  FACTOR=0.01
!
!     COPY COLSUMS IN WW(*), AND SOLVE TRANSPOSED SYSTEM.
  I=1
  N20002=MRELAS
  go to 20003
20002 I=I+1
20003 if ((N20002-I) < 0) go to 20004
  J=IBASIS(I)
  if (.NOT.(J <= NVARS)) go to 20006
  WW(I) = PRIMAL(J)
  go to 20007
20006 if (.NOT.(IND(J) == 2)) go to 20009
  WW(I)=ONE
  go to 20010
20009 WW(I)=-ONE
20010 CONTINUE
20007 CONTINUE
  go to 20002
!
!     PERTURB RIGHT-SIDE IN UNITS OF LAST BITS TO BETTER REFLECT
!     ERRORS IN THE CHECK SUM SOLNS.
20004 I=1
  N20012=MRELAS
  go to 20013
20012 I=I+1
20013 if ((N20012-I) < 0) go to 20014
  WW(I)=WW(I)+TEN*EPS*WW(I)
  go to 20012
20014 TRANS = .TRUE.
  call LA05BD(BASMAT,IBRC,LBM,MRELAS,IPR,IWR,WR,GG,WW,TRANS)
  I=1
  N20016=MRELAS
  go to 20017
20016 I=I+1
20017 if ((N20016-I) < 0) go to 20018
  ERD(I)=MAX(ABS(WW(I)-ONE),EPS)*TUNE
!
!     SYSTEM BECOMES SINGULAR WHEN ACCURACY OF SOLUTION IS  >  FACTOR.
!     THIS VALUE (FACTOR) MIGHT NEED TO BE CHANGED.
  SINGLR=SINGLR.OR.(ERD(I) >= FACTOR)
  go to 20016
20018 ERDNRM=DASUM(MRELAS,ERD,1)
!
!     RECALCULATE ROW CHECK SUMS EVERY ITBRC ITERATIONS OR WHEN
!     A REDECOMPOSITION HAS OCCURRED.
  if (.NOT.(MOD(ITLP,ITBRC) == 0 .OR. REDBAS)) go to 20020
!
!     COMPUTE ROW SUMS, STORE IN WW(*), SOLVE PRIMAL SYSTEM.
  WW(1)=ZERO
  call DCOPY(MRELAS,WW,0,WW,1)
  PAGEPL=.TRUE.
  J=1
  N20023=NVARS
  go to 20024
20023 J=J+1
20024 if ((N20023-J) < 0) go to 20025
  if (.NOT.(IBB(J) >= ZERO)) go to 20027
!
!     THE VARIABLE IS NON-BASIC.
  PAGEPL=.TRUE.
  go to 20023
20027 if (.NOT.(J == 1)) go to 20030
  ILOW=NVARS+5
  go to 20031
20030 ILOW=IMAT(J+3)+1
20031 if (.NOT.(PAGEPL)) go to 20033
  IL1=IDLOC(ILOW,AMAT,IMAT)
  if (.NOT.(IL1 >= LMX-1)) go to 20036
  ILOW=ILOW+2
  IL1=IDLOC(ILOW,AMAT,IMAT)
20036 CONTINUE
  IPAGE=ABS(IMAT(LMX-1))
  go to 20034
20033 IL1=IHI+1
20034 IHI=IMAT(J+4)-(ILOW-IL1)
20039 IU1=MIN(LMX-2,IHI)
  if (.NOT.(IL1 > IU1)) go to 20041
  go to 20040
20041 CONTINUE
  DO 20 I=IL1,IU1
  WW(IMAT(I))=WW(IMAT(I))+AMAT(I)*CSC(J)
20    CONTINUE
  if (.NOT.(IHI <= LMX-2)) go to 20044
  go to 20040
20044 CONTINUE
  IPAGE=IPAGE+1
  KEY=1
  call DPRWPG(KEY,IPAGE,LPG,AMAT,IMAT)
  IL1=NVARS+5
  IHI=IHI-LPG
  go to 20039
20040 PAGEPL=IHI == (LMX-2)
  go to 20023
20025 L=1
  N20047=MRELAS
  go to 20048
20047 L=L+1
20048 if ((N20047-L) < 0) go to 20049
  J=IBASIS(L)
  if (.NOT.(J > NVARS)) go to 20051
  I=J-NVARS
  if (.NOT.(IND(J) == 2)) go to 20054
  WW(I)=WW(I)+ONE
  go to 20055
20054 WW(I)=WW(I)-ONE
20055 CONTINUE
  CONTINUE
20051 CONTINUE
  go to 20047
!
!     PERTURB RIGHT-SIDE IN UNITS OF LAST BIT POSITIONS.
20049 I=1
  N20057=MRELAS
  go to 20058
20057 I=I+1
20058 if ((N20057-I) < 0) go to 20059
  WW(I)=WW(I)+TEN*EPS*WW(I)
  go to 20057
20059 TRANS = .FALSE.
  call LA05BD(BASMAT,IBRC,LBM,MRELAS,IPR,IWR,WR,GG,WW,TRANS)
  I=1
  N20061=MRELAS
  go to 20062
20061 I=I+1
20062 if ((N20061-I) < 0) go to 20063
  ERP(I)=MAX(ABS(WW(I)-ONE),EPS)*TUNE
!
!     SYSTEM BECOMES SINGULAR WHEN ACCURACY OF SOLUTION IS  >  FACTOR.
!     THIS VALUE (FACTOR) MIGHT NEED TO BE CHANGED.
  SINGLR=SINGLR.OR.(ERP(I) >= FACTOR)
  go to 20061
20063 CONTINUE
!
20020 RETURN
end
