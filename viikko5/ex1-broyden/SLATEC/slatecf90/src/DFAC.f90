  DOUBLE PRECISION FUNCTION DFAC (N)
!
!! DFAC computes the factorial function.
!
!***LIBRARY   SLATEC (FNLIB)
!***CATEGORY  C1
!***TYPE      DOUBLE PRECISION (FAC-S, DFAC-D)
!***KEYWORDS  FACTORIAL, FNLIB, SPECIAL FUNCTIONS
!***AUTHOR  Fullerton, W., (LANL)
!***DESCRIPTION
!
! DFAC(N) calculates the double precision factorial for integer
! argument N.
!
!***REFERENCES  (NONE)
!***ROUTINES CALLED  D9LGMC, DGAMLM, XERMSG
!***REVISION HISTORY  (YYMMDD)
!   770601  DATE WRITTEN
!   890531  Changed all specific intrinsics to generic.  (WRB)
!   890531  REVISION DATE from Version 3.2
!   891214  Prologue converted to Version 4.0 format.  (BAB)
!   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
!***END PROLOGUE  DFAC
  DOUBLE PRECISION FACN(31), SQ2PIL, X, XMAX, XMIN,  D9LGMC
  SAVE FACN, SQ2PIL, NMAX
  DATA FACN  (  1) / +.100000000000000000000000000000000D+1    /
  DATA FACN  (  2) / +.100000000000000000000000000000000D+1    /
  DATA FACN  (  3) / +.200000000000000000000000000000000D+1    /
  DATA FACN  (  4) / +.600000000000000000000000000000000D+1    /
  DATA FACN  (  5) / +.240000000000000000000000000000000D+2    /
  DATA FACN  (  6) / +.120000000000000000000000000000000D+3    /
  DATA FACN  (  7) / +.720000000000000000000000000000000D+3    /
  DATA FACN  (  8) / +.504000000000000000000000000000000D+4    /
  DATA FACN  (  9) / +.403200000000000000000000000000000D+5    /
  DATA FACN  ( 10) / +.362880000000000000000000000000000D+6    /
  DATA FACN  ( 11) / +.362880000000000000000000000000000D+7    /
  DATA FACN  ( 12) / +.399168000000000000000000000000000D+8    /
  DATA FACN  ( 13) / +.479001600000000000000000000000000D+9    /
  DATA FACN  ( 14) / +.622702080000000000000000000000000D+10   /
  DATA FACN  ( 15) / +.871782912000000000000000000000000D+11   /
  DATA FACN  ( 16) / +.130767436800000000000000000000000D+13   /
  DATA FACN  ( 17) / +.209227898880000000000000000000000D+14   /
  DATA FACN  ( 18) / +.355687428096000000000000000000000D+15   /
  DATA FACN  ( 19) / +.640237370572800000000000000000000D+16   /
  DATA FACN  ( 20) / +.121645100408832000000000000000000D+18   /
  DATA FACN  ( 21) / +.243290200817664000000000000000000D+19   /
  DATA FACN  ( 22) / +.510909421717094400000000000000000D+20   /
  DATA FACN  ( 23) / +.112400072777760768000000000000000D+22   /
  DATA FACN  ( 24) / +.258520167388849766400000000000000D+23   /
  DATA FACN  ( 25) / +.620448401733239439360000000000000D+24   /
  DATA FACN  ( 26) / +.155112100433309859840000000000000D+26   /
  DATA FACN  ( 27) / +.403291461126605635584000000000000D+27   /
  DATA FACN  ( 28) / +.108888694504183521607680000000000D+29   /
  DATA FACN  ( 29) / +.304888344611713860501504000000000D+30   /
  DATA FACN  ( 30) / +.884176199373970195454361600000000D+31   /
  DATA FACN  ( 31) / +.265252859812191058636308480000000D+33   /
  DATA SQ2PIL / 0.91893853320467274178032973640562D0 /
  DATA NMAX / 0 /
!***FIRST EXECUTABLE STATEMENT  DFAC
  if (NMAX /= 0) go to 10
  call DGAMLM (XMIN, XMAX)
  NMAX = XMAX - 1.D0

 10   if (N  <  0) call XERMSG ('SLATEC', 'DFAC', &
     'FACTORIAL OF NEGATIVE INTEGER UNDEFINED', 1, 2)

  if ( N <= 30 ) then
    DFAC = FACN(N+1)
    RETURN
  end if

  if ( N  >  NMAX ) then
    call XERMSG ('SLATEC', 'DFAC', &
     'N SO BIG FACTORIAL(N) OVERFLOWS', 2, 2)
  end if

  X = N + 1
  DFAC = EXP ((X-0.5D0)*LOG(X) - X + SQ2PIL + D9LGMC(X) )

  return
end
